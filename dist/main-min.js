!function(t,e){if("function"==typeof define&&define.amd)define(["Parse","TraceKit","jQuery","lodash","css","require"],e);else{e(Box,$)}}(0,function(t,e,n,r,o,i){function s(e){var r,o=[],i=new Image;e.stack&&e.stack.length&&(n.each(e.stack,function(t,e){var n=function(t){if(t.url){var e,n,r={file:t.url,line:t.line,col:t.column,func:t.func||"?"},o=function(t){if(t.context){for(var e=t.context,n=~~(e.length/2),r=e.length,o=!1;r--;)if(e[r].length>300){o=!0;break}if(o){if(void 0===t.column)return;return[[],e[n].substr(t.column,50),[]]}return[e.slice(n>2?n-2:0,n),e[n],e.slice(n+1,n>2?n+3:e.length-1)]}}(t);if(o)for(e=["pre_context","context_line","post_context"],n=3;n--;)r[e[n]]=o[n];return r.in_app=!(/(Box|Parse|TraceKit)\./.test(r.function)||/engine\.(min\.)?js$/.test(r.filename)),r}}(e);n&&o.push(n)}),e.stack=o),r={installId:t.Storage.getItem(t.Storage.generatePath("installationId")),trace:e,url:window.location.href},document.referrer&&(r.Referrer=document.referrer),"undefined"!=typeof console&&"function"==typeof console.error&&console.log(r),"string"!=typeof r.trace.message&&delete r.trace.message,n.each(r.trace.stack,function(t,e){"string"!=typeof e.file&&delete e.file});var s=[],a=JSON.stringify(r,function(t,e){if("object"==typeof e&&null!==e){if(-1!==s.indexOf(e))return;s.push(e)}return e});i.src=t.Trace.reportUrl+"?appId="+encodeURIComponent(t.applicationId)+"&jsKey="+encodeURIComponent(t.javaScriptKey)+"&report="+encodeURIComponent(a),n.notify&&(window.scrollTo&&window.scrollTo(0,0),n.notify({title:"Got an error",message:"Hit an error again :( .<br/> But we log and analyze and resolve asap. <br/>"+(e.message?"(<i>"+e.message+"</i>)":""),icon:"fa fa-bug"},{type:"danger",timer:5e3}))}Number.prototype.format||(Number.prototype.format=function(t,e){var n="\\d(?=(\\d{"+(e||3)+"})+"+(t>0?"\\.":"$")+")";return this.toFixed(Math.max(0,~~t)).replace(new RegExp(n,"g"),"$&,")}),Object.unflatten=function(t){"use strict";if(Object(t)!==t||Array.isArray(t))return t;var e=/\.?([^.\[\]]+)|\[(\d+)\]/g,n={};for(var r in t){for(var o,i=n,s="";o=e.exec(r);)i=i[s]||(i[s]=o[2]?[]:{}),s=o[2]||o[1];i[s]=t[r]}return n[""]||n},Object.flatten=function(t){var e={};return function t(n,r){if(Object(n)!==n)e[r]=n;else if(Array.isArray(n)){for(var o=0,i=n.length;o<i;o++)t(n[o],r+"["+o+"]");0===i&&(e[r]=[])}else{var s=!0;for(var a in n)s=!1,t(n[a],r?r+"."+a:a);s&&r&&(e[r]={})}}(t,""),e},Number.prototype.toByteSize=function(){if(!this)return"0 Byte";var t=parseInt(Math.floor(Math.log(this)/Math.log(1024)));return(this/Math.pow(1024,t)).format(2)+" "+["Bytes","KB","MB","GB","TB"][t]},Number.prototype.toPeriod=function(){var t=this;function e(t){return t>1?"s":""}var n=Math.floor(t/31536e3);if(n)return n+" year"+e(n);var r=Math.floor((t%=31536e3)/86400);if(r)return r+" day"+e(r);var o=Math.floor((t%=86400)/3600);if(o)return o+" hour"+e(o);var i=Math.floor((t%=3600)/60);if(i)return i+" minute"+e(i);var s=t%60;return s+" second"+e(s)},"function"!=typeof String.prototype.format&&(String.prototype.format=function(){"use strict";var t=this.toString();if(!arguments.length)return t;var e,n=typeof arguments[0],r="string"===n||"number"===n?arguments:arguments[0];for(e in r)t=t.replace(new RegExp("\\{"+e+"\\}","gi"),r[e]);return t}),"function"!=typeof String.prototype.escapeHtmlAttribute&&(String.prototype.escapeHtmlAttribute=function(){"use strict";var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return this.toString().replace(/[&<>"'\/]/g,function(e){return t[e]})}),"function"!=typeof String.prototype.escapeHtml&&(String.prototype.escapeHtml=function(){"use strict";var t={"&":"&amp;","<":"&lt;",">":"&gt;"};return this.toString().replace(/[&<>]/g,function(e){return t[e]})}),"function"!=typeof String.prototype.trunc&&(String.prototype.trunc=function(t,e){"use strict";var n=this.length>t,r=n?this.substr(0,t-1):this;return r=e&&n?r.substr(0,r.lastIndexOf(" ")):r,n?r+"&hellip;":r}),"function"!=typeof String.isString&&(String.isString=function(t){return"string"==typeof t||t instanceof String}),function(){"use strict";if(navigator.userAgent.match(/IEMobile\/10\.0/)){var t=document.createElement("style");t.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.querySelector("head").appendChild(t)}}(),t.serverURL="/api",t.Trace={reportUrl:"/box/trace/error",captureException:function(t,n){if(t&&!(t instanceof Error))return this.captureMessage(t);try{e.report(t,n)}catch(e){if(t!==e)throw e}return this},captureMessage:function(t){return"string"==typeof t&&(t={message:t}),s(t),this}},e.report.subscribe(s.bind(t.Trace)),e.remoteFetching="undefined"==typeof CDN_ROOT||!CDN_ROOT,window.addEventListener("unhandledrejection",function(){console.log(arguments)}),t.Socket={client:function(){return t.__ioSocket?Promise.resolve(t.__ioSocket):t.Utils.require("socket-io").then(function(e){return t._getInstallationId().then(function(n){var r={applicationId:t.applicationId,javaScriptKey:t.CoreManager.get("JAVASCRIPT_KEY"),installationId:n};return t.User.current()&&(r.sessionToken=t.User.current().getSessionToken()),t.__ioSocket=e({autoConnect:!1,query:r}),t.__ioSocket})})},hasClient:function(){return!!t.__ioSocket},emit:function(){var e=Array.prototype.slice.call(arguments);return t.Socket.client().then(function(t){return new Promise(function(n,r){e.push(function(){var t=Array.prototype.slice.call(arguments);n.apply(null,t)}),t.emit.apply(t,e)})})}};var a,c={},u=/\s+/,l=function(t,e,n,r,o){var i,s=0;if(n&&"object"==typeof n){void 0!==r&&"context"in o&&void 0===o.context&&(o.context=r);for(i=Object.keys(n);s<i.length;s++)e=l(t,e,i[s],n[i[s]],o)}else if(n&&u.test(n))for(i=n.split(u);s<i.length;s++)e=t(e,i[s],r,o);else e=t(e,n,r,o);return e};c.on=function(t,e,n){(this._events=l(f,this._events||{},t,e,{context:n,ctx:this,listening:a}),a)&&((this._listeners||(this._listeners={}))[a.id]=a,a.interop=!1);return this},c.listenTo=function(t,e,n){if(!t)return this;var o=t._listenId||(t._listenId=r.uniqueId("l")),i=this._listeningTo||(this._listeningTo={}),s=a=i[o];s||(this._listenId||(this._listenId=r.uniqueId("l")),s=a=i[o]=new y(this,t));var c=p(t,e,n,this);if(a=void 0,c)throw c;return s.interop&&s.on(e,n),this};var f=function(t,e,n,r){if(n){var o=t[e]||(t[e]=[]),i=r.context,s=r.ctx,a=r.listening;a&&a.count++,o.push({callback:n,context:i,ctx:i||s,listening:a})}return t},p=function(t,e,n,r){try{t.on(e,n,r)}catch(t){return t}};c.off=function(t,e,n){return this._events?(this._events=l(d,this._events,t,e,{context:n,listeners:this._listeners}),this):this},c.stopListening=function(t,e,n){var o=this._listeningTo;if(!o)return this;for(var i=t?[t._listenId]:Object.keys(o),s=0;s<i.length;s++){var a=o[i[s]];if(!a)break;a.obj.off(e,n,this),a.interop&&a.off(e,n)}return r.isEmpty(o)&&(this._listeningTo=void 0),this};var d=function(t,e,n,r){if(t){var o,i=r.context,s=r.listeners,a=0;if(e||i||n){for(o=e?[e]:Object.keys(t);a<o.length;a++){var c=t[e=o[a]];if(!c)break;for(var u=[],l=0;l<c.length;l++){var f=c[l];if(n&&n!==f.callback&&n!==f.callback._callback||i&&i!==f.context)u.push(f);else{var p=f.listening;p&&p.off(e,n)}}u.length?t[e]=u:delete t[e]}return t}for(o=Object.keys(s);a<o.length;a++)s[o[a]].cleanup()}};c.once=function(t,e,n){var o=l(h,{},t,e,r.bind(this.off,this));return"string"==typeof t&&null==n&&(e=void 0),this.on(o,e,n)},c.listenToOnce=function(t,e,n){var o=l(h,{},e,n,r.bind(this.stopListening,this,t));return this.listenTo(t,o)};var h=function(t,e,n,o){if(n){var i=t[e]=r.once(function(){o(e,i),n.apply(this,arguments)});i._callback=n}return t};c.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),r=0;r<e;r++)n[r]=arguments[r+1];return l(g,this._events,t,void 0,n),this};var g=function(t,e,n,r){if(t){var o=t[e],i=t.all;o&&i&&(i=i.slice()),o&&v(o,r),i&&v(i,[e].concat(r))}return t},v=function(t,e){var n,r=-1,o=t.length,i=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<o;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<o;)(n=t[r]).callback.call(n.ctx,i);return;case 2:for(;++r<o;)(n=t[r]).callback.call(n.ctx,i,s);return;case 3:for(;++r<o;)(n=t[r]).callback.call(n.ctx,i,s,a);return;default:for(;++r<o;)(n=t[r]).callback.apply(n.ctx,e);return}},y=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};y.prototype.on=c.on,y.prototype.off=function(t,e){var n;this.interop?(this._events=l(d,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},y.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},c.bind=c.on,c.unbind=c.off,t.Events=c,t._=r,t.$=n;var _=t.Object.prototype.set;if(r.extend(t.Object.prototype,c,{set:function(){var t=["change"].concat(Array.prototype.slice.call(arguments));_.apply(this,arguments),this.trigger.apply(this,t)}}),t.getRouter=function(e,r,o){return t._router?Promise.resolve(t._router):(void 0===r&&(r=!0),o=o||"#!",t.Utils.require("Navigo").then(function(i){var s;return t._router=new i(e,r,o),t._router.events=Object.assign({},c),s=t._router._callLeave,t._router._callLeave=function(){t._router.events.trigger("leave"),s.apply(t._router)},t._router.notFound(function(){t._router._lastRouteResolved&&t._router._lastRouteResolved.url&&n.ajax({type:"GET",url:t._router._lastRouteResolved.url+".html",dataType:"html",beforeSend:function(e){t._router.events.trigger("loading"),t._router.$container&&t._router.$container.css({opacity:"0.0"})}}).then(function(e){t._router.$container&&(t._router.controller&&"function"==typeof t._router.controller.leave?t._router.controller.leave():Promise.resolve()).then(function(){var n;t._router.$container.html(e).delay(50).animate({opacity:"1.0"},300),t._router.events.trigger("loaded"),t._router.updatePageLinks(),(n=t._router.$container.children(":first").data("controller"))&&t.Utils.require(n).then(function(e){t._router.controller=e,t._router.controller&&"function"==typeof t._router.controller.init&&t._router.controller.init(t._router.$container)})})},function(e,n,r){t._router.events.trigger("error"),t._router.$container&&t._router.$container.animate({opacity:"1.0"},300)})}),Promise.resolve(t._router)}))},t.Utils={ismobile:/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()),isFunction:function(t){return"[object Function]"===Object.prototype.toString.apply(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.apply(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.apply(t)},isDate:function(t){return"[object Date]"===Object.prototype.toString.apply(t)},isBoolean:function(t){return"[object Boolean]"===Object.prototype.toString.apply(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.apply(t)},isString:function(t){return"[object String]"===Object.prototype.toString.apply(t)},isValue:function(e){return!t.Utils.isObject(e)&&!t.Utilsthis.isArray(e)&&!t.Utils.isFunction(e)},diff:{VALUE_CREATED:"created",VALUE_UPDATED:"updated",VALUE_DELETED:"deleted",VALUE_UNCHANGED:"unchanged",map:function(e,n){if(t.Utils.isFunction(e)||t.Utils.isFunction(n))throw"Invalid argument. Function given, object expected.";if(t.Utils.isValue(e)||t.Utils.isValue(n))return{type:t.Utils.diff.compareValues(e,n),data:void 0===e?n:e};var r,o={};for(r in e)if(!t.Utils.isFunction(e[r])){var i=void 0;void 0!==n[r]&&(i=n[r]),o[r]=t.Utils.diff.map(e[r],i)}for(r in n)t.Utils.isFunction(n[r])||void 0!==o[r]||(o[r]=t.Utils.map(void 0,n[r]));return o},compareValues:function(e,n){return e===n?t.Utils.diff.VALUE_UNCHANGED:t.Utils.isDate(e)&&t.Utils.isDate(n)&&e.getTime()===n.getTime()?t.Utils.diff.VALUE_UNCHANGED:void 0===e?t.Utils.diff.VALUE_CREATED:void 0===n?t.Utils.diff.VALUE_DELETED:t.Utils.diff.VALUE_UPDATED}},render:function(e,n,r){return Promise.resolve().then(function(){return"undefined"!=typeof dust?dust:(define.amd.dust=!0,t.Utils.require("dust-helpers").then(function(e){var n=e||dust;return"object"==typeof exports&&"object"==typeof global&&(global.dust=global.dust||n),n.onLoad=r||function(e,n){t.Utils.require([e]).then(function(t){n(null,t&&t.length?t[0]:null)})},n}))}).then(function(t){return new Promise(function(r,o){t.render(e,n,function(t,e){if(t)return o(t);r(e)})})})},require:function(e){var n=Array.isArray(e),r=n?e:Array.prototype.slice.call(arguments);return new Promise(function(e,o){i(r,function(){var t=Array.prototype.slice.call(arguments);e(n||r.length>1?t:t[0])},function(e){t.Trace.captureException(e),o(e)})})},inputDigitsOnly:function(t){n.each(t,function(t,e){n(e).keydown(function(t){-1!==n.inArray(t.keyCode,[8,9,27,13,110,189,190])||65===t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()})})},validateEmail:function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},hookLogout:function(e){n(e||'[data-action="userLogout"]').click(function(e){var r=n(this).attr("href")||n(this).data("redirect");e.preventDefault(),t.User.logOut().then(function(){r?window.location=r:window.location.reload(!0)})})},hookUserUI:function(e){(e||!n(document.body).hasClass("active-user")&&!n(document.body).hasClass("anonymous-user"))&&(t.User.current()?(n(document.body).removeClass("anonymous-user").addClass("active-user"),t.User.current().getRoles().then(function(t){n.each(t,function(t,e){n(document.body).addClass("role-"+e.get("name"))})})):n(document.body).removeClass("active-user").addClass("anonymous-user"))},hexOctet:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},generateId:function(){var e=t.Utils.hexOctet;return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},hasAccess:function(e,n){return n=n||"write",!e||t.masterKey?Promise.resolve(!0):(e="function"==typeof e.toJSON?e.toJSON():e)["*"]&&e["*"][n]?Promise.resolve(!0):t.User.currentAsync().then(function(t){return t?e[t.id]&&e[t.id][n]?Promise.resolve(!0):t.getRoles().then(function(t){var r,o,i=!1;for(r=0;r<t.length&&!i;r++)o="role:"+t[r].getName(),i=i||e[o]&&e[o][n];return Promise.resolve(i)}):Promise.resolve(!1)})},querystring:{parse:function(t){var e={};if("string"==typeof(t=void 0!==t?t:window.location.search)&&t.length>0){"?"===t[0]&&(t=t.substring(1));for(var n=0,r=(t=t.split("&")).length;n<r;n++){var o,i,s=t[n],a=s.indexOf("=");a>=0?(o=s.substr(0,a),i=s.substr(a+1)):(o=s,i=""),i=decodeURIComponent(i),void 0===e[o]?e[o]=i:e[o]instanceof Array?e[o].push(i):e[o]=[e[o],i]}}return e},stringify:function(t){var e=[];if(t&&t.constructor===Object)for(var n in t)if(t[n]instanceof Array)for(var r=0,o=t[n].length;r<o;r++)e.push([encodeURIComponent(n),encodeURIComponent(t[n][r])].join("="));else e.push([encodeURIComponent(n),encodeURIComponent(t[n])].join("="));return e.join("&")}},debounce:function(t,e,n){var r;return function(){var o=this,i=arguments,s=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||t.apply(o,i)},e||250),s&&t.apply(o,i)}},throttle:function(t,e){var n,r;return e=e||250,function(){var o=this,i=+new Date,s=arguments;n&&i<n+e?(clearTimeout(r),r=setTimeout(function(){n=i,t.apply(o,s)},e)):(n=i,t.apply(o,s))}},getValue:function(t,e){for(var n=t.split("."),r=e||window,o=0;void 0!==r&&o<n.length;o+=1)r=r[n[o]];return r}},t.User.prototype.getRoles=function(e){var n=this;return this.__roles?Promise.resolve(this.__roles):new t.Query(t.Role).equalTo("users",n).find(e).then(function(t){return n.__roles=t,Promise.resolve(t)})},t.setVolatileStorage=function(e){var n=void 0===e||!!e,r=n?window.sessionStorage:window.localStorage;window.localStorage.setItem("stg:volatile",n?"yes":"no"),t.CoreManager.setStorageController({async:0,getItem:function(t){return r.getItem(t)},setItem:function(t,e){try{r.setItem(t,e)}catch(t){}},removeItem:function(t){r.removeItem(t)},clear(){r.clear()}})},"yes"===window.localStorage.getItem("stg:volatile")&&t.setVolatileStorage(),"undefined"!=typeof __box){if("function"==typeof __box.ignite)return __box.ignite(t);void 0!==__box.appId&&void 0!==__box.javaScriptKey&&(t._initialize(__box.appId,__box.javaScriptKey,__box.masterKey||__box.readOnlyMasterKey),t.serverURL=__box.serverURL||t.serverURL)}return t.User._registerAuthenticationProvider({getAuthType:function(){return"anonymous"},restoreAuthentication:function(){return!0}}),t});